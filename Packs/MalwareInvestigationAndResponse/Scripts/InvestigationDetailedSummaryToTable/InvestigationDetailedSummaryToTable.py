import traceback
from typing import Any, Dict

import demistomock as demisto
from CommonServerPython import *
from CommonServerUserPython import *


def table_command(context: dict) -> CommandResults:
    human_readable = []
    for tactic, values in context.items():
        human_readable.append(tableToMarkdown(name=tactic, t=list(values)))
    return '\n'.join(human_readable)


def main():
    try:
        context = demisto.callingContext.get('context', {}).get('ExecutionContext', {}) \
            .get('InvestigationDetailedSummary', {})
        return_results(table_command(context))
    except Exception as ex:
        demisto.error(traceback.format_exc())  # print the traceback
        return_error(f'Failed to execute InvestigationDetailedSummaryToTable. Error: {str(ex)}')


''' ENTRY POINT '''

if __name__ in ('__main__', '__builtin__', 'builtins'):
    main()
