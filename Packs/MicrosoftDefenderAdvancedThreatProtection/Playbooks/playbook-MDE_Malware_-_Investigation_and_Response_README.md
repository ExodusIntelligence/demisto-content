

## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* MDE - False Positive Incident Handling
* Search For Hash In Sandbox- Generic
* MDE - True Positive Incident Handling
* MDE - Advanced Hunting
* MDE Malware - Incident Enrichment
* Command-Line Analysis
* MDE - Retrieve File 
* MDE - Pro-Active Actions
* Dedup - Generic v4
* Detonate and Analyze File - Generic

### Integrations
This playbook does not use any integrations.

### Scripts
* ZipStrings
* MalwareFindingsParse

### Commands
* setIncident

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| TicketingSystemToUse | Possible Options: SNOW / Jira <br/>\*SNOW == ServiceNow |  | Optional |
| RetrieveFile | Indicates if file retrieval from the endpoint is allowed.<br/>True/False |  | Optional |
| DetonateFile | Indicates if file detonation is allowed on the sandbox.<br/>True/False |  | Optional |
| EnableDeduplication | "Indicates if the deduplication playbook will be used.<br/>    True/False" |  | Optional |
| BenignTagName | The name of the tag to apply for allowed indicators. |  | Optional |
| RunInvestigationActivities | Choose if you would like to run automatically Investigation Activities. \(This relies on \`ActionTask\` input \).<br/>Possible values: True/False |  | Optional |
| AdvancedHunting | Choose if you want to run Advance Hunting queries through your Microsoft Defender For Endpoint Instance. Note that it may take some time. | True | Optional |
| DeduphandleSimilar | This input defines how to handle Similar incidents. <br/>You may choose between: "Link", "Close", "Link and Close".<br/>Note: that closing incidents will require you to define "CloseSimilar" input as well.<br/>Also, note that the closer will apply on at least one of the options \(indicators or fields\) which will match the "closer percentage" criteria.<br/>Default: Link  | Link and Close | Optional |
| DedupCloseSimilar | Define if you would like to close incidents by a similarity percentage. The percentage will be the bottom border for closing inc.<br/>This option will close also exact matches as well \( if there are\).<br/>Value should be between 0 to 1 \[0=low similarity , 1=identical\] | 0.9 | Optional |
| EnableClosureSteps | Indicates if the use of closure steps is allowed or incident will close automatically.<br/>    True/False | True | Optional |
| TicketProjectName | In case you are using Jira, please specify the Jira Project Key here \( can be retrieved from the Jira console\) |  | Optional |
| AutoCollectinvestigationPackege | Choose if you would like to autorun action to collect Investigation Package from an Endpoint.<br/>Possible values: True/False | False | Optional |
| ActionTask | Option for input \( can be entered as comma-separated values\):<br/>\`Full Scan\` - Fully Scan the provided endpoint/s<br/>\`Collect Investigation Package\` - Collect investigation package from endpoint/s \(only for supported devices\)<br/>\`Automated Investigation\` - Run Automated Investigation on the provided endpoint<br/>In case it will remain empty, the actions should be checked manually. |  | Optional |
| AutoAVScan | Choose if you would like to autorun a Full AV Scan on your Endpoint.<br/>Possible values: True/False | False | Optional |
| AutoAutomatedInvestigation | Choose if you would like to autorun Automated Investigation on your Endpoint.<br/>Possible values: True/False | False | Optional |
| MaliciousTagName | The tag to assign for indicators to block. |  | Optional |
| AutoUnisolation | Indicates if automatic un-isolation is allowed<br/>    True/False |  | Optional |
| DidAlertOriginateFromSIEM | In case the alert originated from SIEM no need to run the Incident enrichment flow. |  | Optional |
| DedupSimilarTextField | Comma-separated list of incident text fields to take into account when computing similarity. For example commandline, URL | agnetsid,users,agentsid,CMDline,Hostnames,filenames,filepaths | Optional |
| AutoIsolation | Indicates if endpoint isolation is allowed.<br/>True/False |  | Optional |
| DedupMinimunIncidentSimilarity | Retain incidents with a similarity score that's higher than the MinimunIncidentSimilarity.<br/>Default: 0.2<br/>Value should be between 0 to 1 \[0=low similarity, 1=identical\] |  | Optional |
| DedupLimit | The maximum number of incidents to query and set to context data.<br/>Default is: 200 |  | Optional |

## Playbook Outputs
---
There are no outputs for this playbook.

## Playbook Image
---
![MDE Malware - Investigation and Response](Insert the link to your image here)