This playbook aims to enrich Microsoft Defender For Endpoint alert. The enrichment is done on: the involved endpoint, Mitre technique ID information, and sets the 'Malware-Investigation and Response' layout.

## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* Mitre Attack - Extract Technique Information From ID
* 1d1d0c8b-f429-4cbb-8de5-a0fb2742f1d6

### Integrations
* MicrosoftDefenderAdvancedThreatProtection

### Scripts
* SetAndHandleEmpty
* isError

### Commands
* setIncident
* microsoft-atp-get-alert-by-id
* file
* endpoint

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| DidAlertOriginateFromSIEM | Define if the incident is fetched through a SIEM product. <br/>Possible values: True/False  | False | Optional |
| AlertID | Enter the Microsoft Defender For Endpoint Alert ID. | ${incident.externalsystemid} | Optional |

## Playbook Outputs
---

| **Path** | **Description** | **Type** |
| --- | --- | --- |
| MITREATTACK | Full MITRE data for the attack pattern. | string |
| AttackPattern | Array of attack patterns name and ID's. | string |
| MicrosoftATP.Alert | Microsft Defender For Endpoint Alert inforamtion. | unknown |
| Endpoint | Endpoint information. | unknown |

## Playbook Image
---
![MDE Malware - Incident Enrichment](../doc_files/MDE_Malware_-_Incident_Enrichment.png)