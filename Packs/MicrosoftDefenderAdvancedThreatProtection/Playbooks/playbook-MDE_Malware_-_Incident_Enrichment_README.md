This playbook enriches Microsoft Defender For Endpoint alerts. The enrichment is done on the involved endpoint and Mitre technique ID information, and it sets the 'Malware-Investigation and Response' layout.

## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* Mitre Attack - Extract Technique Information From ID
* 1d1d0c8b-f429-4cbb-8de5-a0fb2742f1d6

### Integrations
MicrosoftDefenderAdvancedThreatProtection

### Scripts
* SetAndHandleEmpty
* isError

### Commands
* setIncident
* microsoft-atp-get-alert-by-id
* file
* endpoint

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| DidAlertOriginateFromSIEM | Whether the incident is fetched through a SIEM product.  | No | Optional |
| AlertID | The Microsoft Defender For Endpoint alert ID. | ${incident.externalsystemid} | Optional |

## Playbook Outputs
---

| **Path** | **Description** | **Type** |
| --- | --- | --- |
| MITREATTACK | Full MITRE data for the attack pattern. | string |
| AttackPattern | An array of attack pattern names and IDs. | string |
| MicrosoftATP.Alert | Microsoft Defender For Endpoint alert information. | unknown |
| Endpoint | The endpoint information. | unknown |

## Playbook Image
---
![MDE Malware - Incident Enrichment](../doc_files/MDE_Malware_-_Incident_Enrichment.png)
