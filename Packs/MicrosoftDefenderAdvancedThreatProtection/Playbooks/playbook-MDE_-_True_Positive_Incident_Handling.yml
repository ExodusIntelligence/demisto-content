id: MDE - True Positive Incident Handling
version: -1
name: MDE - True Positive Incident Handling
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: 8b0086d0-9ebb-4369-8321-36545b6dada6
    type: start
    task:
      id: 8b0086d0-9ebb-4369-8321-36545b6dada6
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '31'
      - '21'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1750,
          "y": -170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '1':
    id: '1'
    taskid: 6fd207d1-791f-4b90-850b-a28c922534b3
    type: regular
    task:
      id: 6fd207d1-791f-4b90-850b-a28c922534b3
      version: -1
      name: Retrieve MSDE alerts ID based on XSOAR investigation
      description: |-
        Searches Demisto incidents.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: SearchIncidentsV2
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '2'
    scriptarguments:
      id:
        complex:
          root: inputs.DupAlertIDsToBeClosed
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1450,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '2':
    id: '2'
    taskid: 5d72a24f-10c7-482a-816b-2fcda6abc292
    type: regular
    task:
      id: 5d72a24f-10c7-482a-816b-2fcda6abc292
      version: -1
      name: Resolve MSDE Alert
      description: Update the properties of an alert entity.
      script: '|||microsoft-atp-update-alert'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '7'
    scriptarguments:
      alert_id:
        complex:
          root: foundIncidents.CustomFields
          accessor: alertid
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: incident.alertid
                iscontext: true
      classification:
        simple: ${inputs.Classification}
      comment:
        simple: ${inputs.Comment}
      determination:
        simple: ${inputs.Reason}
      status:
        simple: Resolved
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '3':
    id: '3'
    taskid: 3c963ac6-062d-43ad-82d3-e32d2345e793
    type: title
    task:
      id: 3c963ac6-062d-43ad-82d3-e32d2345e793
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '7':
    id: '7'
    taskid: e02da1ef-4f9b-48f0-85e3-b035227d72c2
    type: regular
    task:
      id: e02da1ef-4f9b-48f0-85e3-b035227d72c2
      version: -1
      name: Close  XSOAR incident
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '3'
    scriptarguments:
      closeReason:
        simple: ${inputs.Reason}
      id:
        complex:
          root: foundIncidents
          accessor: id
          transformers:
          - operator: append
            args:
              item:
                value:
                  simple: incident.id
                iscontext: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '19':
    id: '19'
    taskid: a7a8d82f-ac6a-467a-892d-6ba89029b3f9
    type: condition
    task:
      id: a7a8d82f-ac6a-467a-892d-6ba89029b3f9
      version: -1
      name: Approve isolation
      description: Approve isolation
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '44'
      Yes:
      - '34'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2310,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
        simple: Approve Endpoint Isolation
      methods: []
      format: ''
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
      replyOptions:
      - Yes
      - No
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '20':
    id: '20'
    taskid: 2ae67c4c-b175-4ee2-8888-072b0b96aef6
    type: condition
    task:
      id: 2ae67c4c-b175-4ee2-8888-072b0b96aef6
      version: -1
      name: Auto Isolate the endpoint
      description: Auto Isolate the endpoint
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '19'
      yes:
      - '34'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AutoIsolation
            iscontext: true
          right:
            value:
              simple: 'true'
    view: |-
      {
        "position": {
          "x": -2100,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '21':
    id: '21'
    taskid: 2f959592-1d1d-4eae-8ad2-c632c36824e0
    type: title
    task:
      id: 2f959592-1d1d-4eae-8ad2-c632c36824e0
      version: -1
      name: IT Remediation
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '22'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -840,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '22':
    id: '22'
    taskid: 3b6433b2-87f6-4f3e-87cc-97ef20c7330e
    type: condition
    task:
      id: 3b6433b2-87f6-4f3e-87cc-97ef20c7330e
      version: -1
      name: Is a ticketing system defined?
      description: Is a ticketing system defined?
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '25'
      JIRA:
      - '57'
      SNOW:
      - '56'
    separatecontext: false
    conditions:
    - label: SNOW
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.TicketingSystemToUse
            iscontext: true
          right:
            value:
              simple: SNOW
    - label: JIRA
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.TicketingSystemToUse
            iscontext: true
          right:
            value:
              simple: JIRA
    view: |-
      {
        "position": {
          "x": -840,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '25':
    id: '25'
    taskid: 31e524b7-6bc7-4fc4-86d8-cd3c526e5cd6
    type: title
    task:
      id: 31e524b7-6bc7-4fc4-86d8-cd3c526e5cd6
      version: -1
      name: Done auditing step
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '32'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -840,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '26':
    id: '26'
    taskid: 022b1f1e-2c09-4ea5-8eb5-0cfa04fb0d9f
    type: title
    task:
      id: 022b1f1e-2c09-4ea5-8eb5-0cfa04fb0d9f
      version: -1
      name: Block Indicators
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '27'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '27':
    id: '27'
    taskid: 37b1e072-5295-4c20-8b36-6620c685afeb
    type: collection
    task:
      id: 37b1e072-5295-4c20-8b36-6620c685afeb
      version: -1
      name: Confirm Indicators to block
      description: Confirm Indicators to block
      type: collection
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '72'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ''
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: '0'
        label: ''
        labelarg:
          simple: Mark the indicators to block
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - simple: ${incident.filesha256}
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      title: Indicators to block
      description: ''
      sender: ''
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '29':
    id: '29'
    taskid: 0bda6212-cc57-479f-8f57-7154e95f96cd
    type: regular
    task:
      id: 0bda6212-cc57-479f-8f57-7154e95f96cd
      version: -1
      name: Tag Indicators
      description: commands.local.cmd.set.indicators
      script: Builtin|||setIndicators
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '30'
    scriptarguments:
      indicatorsValues:
        simple: ${Indicators to block.Answers.0}
      tags:
        simple: ${inputs.BlockTag}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1770,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '30':
    id: '30'
    taskid: 9f476ea3-8689-4ae4-8ec9-b74d83d3ff6b
    type: title
    task:
      id: 9f476ea3-8689-4ae4-8ec9-b74d83d3ff6b
      version: -1
      name: Done block indicators
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '32'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '31':
    id: '31'
    taskid: 2acaf046-4a42-46f1-8734-aa764f490dbf
    type: title
    task:
      id: 2acaf046-4a42-46f1-8734-aa764f490dbf
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '26'
      - '33'
      - '66'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2100,
          "y": -30
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '32':
    id: '32'
    taskid: ea9bc4c4-6a5a-42c3-8bc4-9cee65cddb86
    type: title
    task:
      id: ea9bc4c4-6a5a-42c3-8bc4-9cee65cddb86
      version: -1
      name: True Positive Incident Closing
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '53'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '33':
    id: '33'
    taskid: 8b64ec97-25f6-4c14-88e3-21ee4335c957
    type: title
    task:
      id: 8b64ec97-25f6-4c14-88e3-21ee4335c957
      version: -1
      name: Isolate
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '20'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2100,
          "y": 110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '34':
    id: '34'
    taskid: 3d50b4ec-7259-4fa9-8f2d-dcad005880bb
    type: playbook
    task:
      id: 3d50b4ec-7259-4fa9-8f2d-dcad005880bb
      version: -1
      name: Microsoft Defender For Endpoint - Isolate Endpoint
      description: This playbook accepts an endpoint ID, IP, or host name and isolates it using the Microsoft Defender For Endpoint integration.
      playbookName: Microsoft Defender For Endpoint - Isolate Endpoint
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '44'
    scriptarguments:
      Device_id:
        simple: ${inputs.HostID}
      Isolation_type:
        simple: Full
    separatecontext: true
    loop:
      iscommand: false
      scriptArguments:
        Device_id:
          simple: ${Endpoint.ID}
        Isolation_type:
          simple: Full
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -2100,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '44':
    id: '44'
    taskid: c3c6e299-3277-47f9-8e14-a6909bebdbe1
    type: title
    task:
      id: c3c6e299-3277-47f9-8e14-a6909bebdbe1
      version: -1
      name: Done with isolating the infected device
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '32'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2100,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '53':
    id: '53'
    taskid: e575ee22-5b49-4061-8640-1f01964e73a0
    type: title
    task:
      id: e575ee22-5b49-4061-8640-1f01964e73a0
      version: -1
      name: Final Closure
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '60'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1160
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '54':
    id: '54'
    taskid: 4b0e11b0-60fd-4630-89f6-a3fecf503e57
    type: regular
    task:
      id: 4b0e11b0-60fd-4630-89f6-a3fecf503e57
      version: -1
      name: Open Snow ticket
      description: |-
        This script is used to wrap the generic create-record command in ServiceNow.
        You can add fields that you want to create the record with as script arguments or in the
        code and work with the records easily.
      scriptName: ServiceNowCreateIncident
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '25'
    scriptarguments:
      description:
        simple: ${inputs.TicketDescription}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1050,
          "y": 535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '56':
    id: '56'
    taskid: 2394b4c9-48a8-4f34-8f74-16d6f6cae38b
    type: condition
    task:
      id: 2394b4c9-48a8-4f34-8f74-16d6f6cae38b
      version: -1
      name: Is ServiceNow Available?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '25'
      yes:
      - '54'
    scriptarguments:
      brandname:
        simple: ServiceNow v2
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1050,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '57':
    id: '57'
    taskid: 7bae04fd-831d-43a4-85d2-490036807ee6
    type: condition
    task:
      id: 7bae04fd-831d-43a4-85d2-490036807ee6
      version: -1
      name: Is Jira Available?
      description: Returns 'yes' if integration brand is available. Otherwise returns 'no'
      scriptName: IsIntegrationAvailable
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '25'
      yes:
      - '70'
    scriptarguments:
      brandname:
        simple: jira-v2
    results:
    - brandInstances
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -630,
          "y": 360
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '60':
    id: '60'
    taskid: 6fae56bf-0575-454f-8b43-b18a1affa536
    type: condition
    task:
      id: 6fae56bf-0575-454f-8b43-b18a1affa536
      version: -1
      name: Additional Duplicate IDs were provided?
      description: Additional Duplicate IDs were provided?
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '2'
      yes:
      - '1'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.DupAlertIDsToBeClosed
            iscontext: true
          right:
            value: {}
      - - operator: containsString
          left:
            value:
              simple: inputs.CloseDuplicate
            iscontext: true
          right:
            value:
              simple: close
          ignorecase: true
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1290
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '62':
    id: '62'
    taskid: cddcf330-2a00-4acb-8514-e8afb8f9922a
    type: regular
    task:
      id: cddcf330-2a00-4acb-8514-e8afb8f9922a
      version: -1
      name: Quarantine this file on an affected machine
      description: Stop the execution of a file on a machine and delete it.
      script: '|||microsoft-atp-stop-and-quarantine-file'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '64'
    scriptarguments:
      comment:
        simple: Emergency containment
      file_hash:
        complex:
          root: File
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: File.Malicious
                iscontext: true
          accessor: SHA1
      machine_id:
        simple: ${MicrosoftATP.FileMachine.Machines.ID}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2570,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '63':
    id: '63'
    taskid: 26d215ab-59d6-4bf3-810a-7d8a7963811a
    type: regular
    task:
      id: 26d215ab-59d6-4bf3-810a-7d8a7963811a
      version: -1
      name: Get a list of devices associated with the malicious/suspicious SHA1 hashes
      description: Get a collection of machines related to a given file SHA1 hash.
      script: '|||microsoft-atp-get-file-related-machines'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '62'
    scriptarguments:
      file_hash:
        complex:
          root: File
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: File.Malicious
                iscontext: true
          accessor: SHA1
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2570,
          "y": 575
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '64':
    id: '64'
    taskid: 3f271aea-d790-4519-82bd-38e0985b3683
    type: title
    task:
      id: 3f271aea-d790-4519-82bd-38e0985b3683
      version: -1
      name: Done with isolating the infected device
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '32'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2570,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '66':
    id: '66'
    taskid: 1bf90a27-a90f-4bcf-8596-8e2a417e2250
    type: title
    task:
      id: 1bf90a27-a90f-4bcf-8596-8e2a417e2250
      version: -1
      name: Remove File
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '71'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '68':
    id: '68'
    taskid: 6a1c3010-89a0-4eb2-824f-5f8943a71ee3
    type: regular
    task:
      id: 6a1c3010-89a0-4eb2-824f-5f8943a71ee3
      version: -1
      name: Create IOC on Microsoft Defender For Endpoint
      description: Creates a new indicator.
      script: '|||microsoft-atp-sc-indicator-create'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '30'
    scriptarguments:
      action:
        simple: Allowed
      indicator_description:
        simple: 'Added by Cortex XSOAR - Incident #${incident.id}'
      indicator_title:
        simple: 'Added by Cortex XSOAR - Incident #${incident.id} '
      indicator_type:
        simple: FileSha256
      indicator_value:
        simple: ${Indicators to block.Answers.0}
      severity:
        simple: Informational
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1280,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '70':
    id: '70'
    taskid: 3db0c6b0-148f-4c4d-8178-733564aa27ba
    type: regular
    task:
      id: 3db0c6b0-148f-4c4d-8178-733564aa27ba
      version: -1
      name: Open Jira Issue
      description: Creates a new issue in Jira.
      script: '|||jira-create-issue'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '25'
    scriptarguments:
      issueTypeName:
        simple: ${inputs.Comment}
      projectKey:
        simple: ${inputs.TicketProjectName}
      summary:
        simple: ${inputs.TicketDescription}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -630,
          "y": 535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '71':
    id: '71'
    taskid: 9c4b706b-4b73-4f5e-8a01-35e1ede98919
    type: collection
    task:
      id: 9c4b706b-4b73-4f5e-8a01-35e1ede98919
      version: -1
      name: Confirm which SHA1 should be deleted
      description: Confirm which SHA1 should be deleted
      type: collection
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '73'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 220
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    message:
      to:
      subject:
      body:
      methods: []
      format: ''
      bcc:
      cc:
      timings:
        retriescount: 2
        retriesinterval: 360
        completeafterreplies: 1
        completeafterv2: true
        completeaftersla: false
    form:
      questions:
      - id: '0'
        label: ''
        labelarg:
          simple: Mark SHA1 to be deleted
        required: false
        gridcolumns: []
        defaultrows: []
        type: multiSelect
        options: []
        optionsarg:
        - simple: ${incident.filesha1}
        fieldassociated: ''
        placeholder: ''
        tooltip: ''
        readonly: false
      title: Confirm which SHA1 should be deleted
      description: ''
      sender: ''
      expired: false
      totalanswers: 0
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '72':
    id: '72'
    taskid: 83e10ad8-4cae-4707-8814-e7848604d2b9
    type: condition
    task:
      id: 83e10ad8-4cae-4707-8814-e7848604d2b9
      version: -1
      name: Was there any hash selected?
      description: Was there any hash selected?
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '30'
      yes:
      - '68'
      - '29'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Indicators to block.Answers.0
            iscontext: true
          right:
            value: {}
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  '73':
    id: '73'
    taskid: 93b5b0a9-c3e0-4d56-8905-470478e92d93
    type: condition
    task:
      id: 93b5b0a9-c3e0-4d56-8905-470478e92d93
      version: -1
      name: Was there any hash selected?
      description: Was there any hash selected?
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '64'
      yes:
      - '63'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: Confirm which SHA1 should be deleted.Answers
            iscontext: true
          right:
            value: {}
    view: |-
      {
        "position": {
          "x": -2780,
          "y": 400
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2190,
        "width": 2530,
        "x": -2780,
        "y": -170
      }
    }
  }
inputs:
- key: DupAlertIDsToBeClosed
  value: {}
  required: false
  description: 'XSOAR Investigation IDs to be closed '
  playbookInputQuery:
- key: Comment
  value:
    simple: 'XSOAR Incident #${incident.id}'
  required: false
  description: Add comment to close an incident on the Microsoft Defender For Endpoint side
  playbookInputQuery:
- key: Reason
  value: {}
  required: false
  description: |-
    Provide a reason for closing the incident. Please choose on of the following suggestions:
    "NotAvailable"/"Apt,Malware"/"SecurityPersonnel"/"SecurityTesting"/"UnwantedSoftware"/"Other"
  playbookInputQuery:
- key: Classification
  value: {}
  required: false
  description: Choose From - "Unknown" / "TruePositive" / "FalsePositive"
  playbookInputQuery:
- key: TicketDescription
  value: {}
  required: false
  description: 'Please Specify the ticket description for this section '
  playbookInputQuery:
- key: BlockTag
  value: {}
  required: false
  description: Specify the banning tag name for founded indicators.
  playbookInputQuery:
- key: TicketProjectName
  value: {}
  required: false
  description: In case you are using Jira, please specify the Jira Project Key here ( can be retrieved from the Jira console)
  playbookInputQuery:
- key: TicketingSystemToUse
  value: {}
  required: false
  description: The name of the ticketing system to use, for example, Jira or ServiceNow
  playbookInputQuery:
- key: AutoIsolation
  value: {}
  required: false
  description: |-
    Indicates if host isolation is allowed.
    True/False
  playbookInputQuery:
- key: CloseDuplicate
  value: {}
  required: false
  description: |-
    Determine if the duplicate incidents should be closed as well in Microsoft Defender Instance.
    The playbook will look for the world "Close" in this input.
  playbookInputQuery:
- key: HostID
  value: {}
  required: false
  description: The ID of the host to use.
  playbookInputQuery:
outputs: []
tests:
- Microsoft Defender Advanced Threat Protection - Test
- Microsoft Defender - ATP - Indicators SC Test
fromversion: 6.2.0
description: This Playbook handles a true-positive incident closure for Microsoft defender for endpoint
