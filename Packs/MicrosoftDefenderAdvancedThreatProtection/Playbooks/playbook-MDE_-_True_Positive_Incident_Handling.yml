contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: 8dfc4c78-6835-4e51-8aaa-ce7852cc8049
    propagationLabels:
    - all
    toServerVersion: ""
id: 87353eea-72a8-43b9-8e91-d9ba986ef5da
inputs:
- description: 'XSOAR Investigation IDs to be closed '
  key: DupAlertIDsToBeClosed
  playbookInputQuery: null
  required: false
  value: {}
- description: Add comment to close an incident on the Microsoft Defender For Endpoint
    side
  key: Comment
  playbookInputQuery: null
  required: false
  value:
    simple: 'XSOAR Incident #${incident.id}'
- description: |-
    Provide a reason for closing the incident. Please choose on of the following suggestions:
    "NotAvailable"/"Apt,Malware"/"SecurityPersonnel"/"SecurityTesting"/"UnwantedSoftware"/"Other"
  key: Reason
  playbookInputQuery: null
  required: false
  value: {}
- description: Choose From - "Unknown" / "TruePositive" / "FalsePositive"
  key: Classification
  playbookInputQuery: null
  required: false
  value: {}
- description: Specify the approving tag name for found indicators.
  key: AllowTag
  playbookInputQuery: null
  required: false
  value: {}
- description: 'Please Specify the ticket description for this section '
  key: TicketDescription
  playbookInputQuery: null
  required: false
  value: {}
- description: Specify the banning tag name for founded indicators.
  key: BlockTag
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Enter the Jira Ticket Summary.
    Default: Cortex XSOAR - Malware Incident - #${incident.id}
  key: JiraSummary
  playbookInputQuery: null
  required: false
  value:
    simple: 'Cortex XSOAR - Malware Incident - #${incident.id}'
- description: |-
    Enter Jira Task Name.
    Default: Malware Investigation - follow up #${incident.id}
  key: JiraTaskName
  playbookInputQuery: null
  required: false
  value:
    simple: 'Malware Investigation - follow up #${incident.id}'
- description: |
    Enter Jira Project Key. Can be seen in the Jira Project information.
  key: JiraProjectKey
  playbookInputQuery: null
  required: false
  value: {}
- description: ""
  key: TicketingSystemToUse
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Indicates if host isolation is allowed.
    True/False
  key: AutoIsolation
  playbookInputQuery: null
  required: false
  value: {}
- description: |-
    Determine if the duplicate incidents should be closed as well in Microsoft Defender Instance.
    The playbook will look for the world "Close" in this input.
  key: CloseDuplicate
  playbookInputQuery: null
  required: false
  value: {}
name: MDE - True Positive Incident Handling
outputs: []
starttaskid: "0"
tasks:
  "0":
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "31"
      - "21"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b0086d0-9ebb-4369-8321-36545b6dada6
      iscommand: false
      name: ""
      version: -1
    taskid: 8b0086d0-9ebb-4369-8321-36545b6dada6
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": -1750,
          "y": -170
        }
      }
  "1":
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          root: inputs.DupAlertIDsToBeClosed
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Searches Demisto incidents.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      id: 6fd207d1-791f-4b90-850b-a28c922534b3
      iscommand: false
      name: Retrieve MSDE alerts ID based on XSOAR investigation
      scriptName: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 6fd207d1-791f-4b90-850b-a28c922534b3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1450,
          "y": 1460
        }
      }
  "2":
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "7"
    note: false
    quietmode: 0
    scriptarguments:
      alert_id:
        complex:
          accessor: alertid
          root: foundIncidents.CustomFields
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: incident.alertid
            operator: append
      classification:
        simple: ${inputs.Classification}
      comment:
        simple: ${inputs.Comment}
      determination:
        simple: ${inputs.Reason}
      status:
        simple: Resolved
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Update the properties of an alert entity.
      id: 5d72a24f-10c7-482a-816b-2fcda6abc292
      iscommand: true
      name: Resolve MSDE Alert
      script: '|||microsoft-atp-update-alert'
      type: regular
      version: -1
    taskid: 5d72a24f-10c7-482a-816b-2fcda6abc292
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1640
        }
      }
  "3":
    id: "3"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3c963ac6-062d-43ad-82d3-e32d2345e793
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 3c963ac6-062d-43ad-82d3-e32d2345e793
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1955
        }
      }
  "7":
    id: "7"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "3"
    note: false
    quietmode: 0
    scriptarguments:
      closeReason:
        simple: ${inputs.Reason}
      id:
        complex:
          accessor: id
          root: foundIncidents
          transformers:
          - args:
              item:
                iscontext: true
                value:
                  simple: incident.id
            operator: append
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.close.inv
      id: e02da1ef-4f9b-48f0-85e3-b035227d72c2
      iscommand: true
      name: Close  XSOAR incident
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: e02da1ef-4f9b-48f0-85e3-b035227d72c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1805
        }
      }
  "19":
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: Approve Endpoint Isolation
      cc: null
      format: ""
      methods: []
      replyOptions:
      - "Yes"
      - "No"
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#default#':
      - "44"
      "Yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b62ee428-f0ec-4e95-8e0c-d601ced5f0ca
      iscommand: false
      name: Approve isolation
      type: condition
      version: -1
    taskid: b62ee428-f0ec-4e95-8e0c-d601ced5f0ca
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2360,
          "y": 400
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.AutoIsolation
          operator: isEqualString
          right:
            value:
              simple: "true"
      label: "yes"
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "19"
      "yes":
      - "34"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 17e63369-ab20-49ca-8028-74ec24a38c4d
      iscommand: false
      name: Auto Isolate the endpoint
      type: condition
      version: -1
    taskid: 17e63369-ab20-49ca-8028-74ec24a38c4d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2150,
          "y": 220
        }
      }
  "21":
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "22"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2f959592-1d1d-4eae-8ad2-c632c36824e0
      iscommand: false
      name: IT Remediation
      type: title
      version: -1
    taskid: 2f959592-1d1d-4eae-8ad2-c632c36824e0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -600,
          "y": -30
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.TicketingSystemToUse
          operator: isEqualString
          right:
            value:
              simple: SNOW
      label: SNOW
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.TicketingSystemToUse
          operator: isEqualString
          right:
            value:
              simple: JIRA
      label: JIRA
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      JIRA:
      - "57"
      SNOW:
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4113e745-a40c-4b01-8eb6-38efe4e4db3e
      iscommand: false
      name: Is a ticketing system defined?
      type: condition
      version: -1
    taskid: 4113e745-a40c-4b01-8eb6-38efe4e4db3e
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -600,
          "y": 180
        }
      }
  "25":
    id: "25"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 31e524b7-6bc7-4fc4-86d8-cd3c526e5cd6
      iscommand: false
      name: Done auditing step
      type: title
      version: -1
    taskid: 31e524b7-6bc7-4fc4-86d8-cd3c526e5cd6
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -600,
          "y": 720
        }
      }
  "26":
    id: "26"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "27"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 022b1f1e-2c09-4ea5-8eb5-0cfa04fb0d9f
      iscommand: false
      name: Block Indicators
      type: title
      version: -1
    taskid: 022b1f1e-2c09-4ea5-8eb5-0cfa04fb0d9f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 110
        }
      }
  "27":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Mark the indicators to block
        options: []
        optionsarg:
        - simple: ${incident.filesha256}
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Indicators to block
      totalanswers: 0
    id: "27"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ec07941c-bcb0-4176-877c-1b940b70296b
      iscommand: false
      name: Confirm Indicators to block
      type: collection
      version: -1
    taskid: ec07941c-bcb0-4176-877c-1b940b70296b
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 220
        }
      }
  "29":
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      indicatorsValues:
        simple: ${Indicators to block.Answers.0}
      tags:
        simple: ${inputs.BlockTag}
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.indicators
      id: 0bda6212-cc57-479f-8f57-7154e95f96cd
      iscommand: true
      name: Tag Indicators
      script: Builtin|||setIndicators
      type: regular
      version: -1
    taskid: 0bda6212-cc57-479f-8f57-7154e95f96cd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1100,
          "y": 720
        }
      }
  "30":
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 9f476ea3-8689-4ae4-8ec9-b74d83d3ff6b
      iscommand: false
      name: Done block indicators
      type: title
      version: -1
    taskid: 9f476ea3-8689-4ae4-8ec9-b74d83d3ff6b
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 890
        }
      }
  "31":
    id: "31"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "26"
      - "33"
      - "66"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 2acaf046-4a42-46f1-8734-aa764f490dbf
      iscommand: false
      name: Remediation
      type: title
      version: -1
    taskid: 2acaf046-4a42-46f1-8734-aa764f490dbf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2150,
          "y": -30
        }
      }
  "32":
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "53"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ea9bc4c4-6a5a-42c3-8bc4-9cee65cddb86
      iscommand: false
      name: True Positive Incident Closing
      type: title
      version: -1
    taskid: ea9bc4c4-6a5a-42c3-8bc4-9cee65cddb86
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1040
        }
      }
  "33":
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 8b64ec97-25f6-4c14-88e3-21ee4335c957
      iscommand: false
      name: Isolate
      type: title
      version: -1
    taskid: 8b64ec97-25f6-4c14-88e3-21ee4335c957
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2150,
          "y": 110
        }
      }
  "34":
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      scriptArguments:
        Device_id:
          simple: ${Endpoint.ID}
        Isolation_type:
          simple: Full
      wait: 1
    nexttasks:
      '#none#':
      - "44"
    note: false
    quietmode: 0
    scriptarguments:
      Device_id:
        simple: ${Endpoint.[0].ID}
      Isolation_type:
        simple: Full
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook will auto isolate endpoints through Microsoft Defender
        For Endpoint by using Hostname,IP, or Device ID associated with the asset
        you wish to block.
      id: 91a9e287-69fa-42a6-805f-efe6de948767
      iscommand: false
      name: Microsoft Defender For Endpoint - Isolate Endpoint
      playbookId: Microsoft Defender For Endpoint - Isolate Endpoint
      type: playbook
      version: -1
    taskid: 91a9e287-69fa-42a6-805f-efe6de948767
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -2150,
          "y": 575
        }
      }
  "44":
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c3c6e299-3277-47f9-8e14-a6909bebdbe1
      iscommand: false
      name: Done with isolating the infected device
      type: title
      version: -1
    taskid: c3c6e299-3277-47f9-8e14-a6909bebdbe1
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2150,
          "y": 890
        }
      }
  "49":
    id: "49"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "29"
      - "68"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: |+
        This playbook blocks malicious Indicators using all integrations that are enabled, using the following sub-playbooks:

        - Block URL - Generic
        - Block Account - Generic
        - Block IP - Generic v2
        - Block File - Generic v2
        - Block Email - Generic
        - Block Domain - Generic

      id: cc051604-ea17-44ae-8485-c46e47d2a357
      iscommand: false
      name: Block Indicators - Generic v2
      playbookId: Block Indicators - Generic v2
      type: playbook
      version: -1
    taskid: cc051604-ea17-44ae-8485-c46e47d2a357
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1320,
          "y": 550
        }
      }
  "53":
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e575ee22-5b49-4061-8640-1f01964e73a0
      iscommand: false
      name: Final Closure
      type: title
      version: -1
    taskid: e575ee22-5b49-4061-8640-1f01964e73a0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1160
        }
      }
  "54":
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      description:
        simple: ${inputs.TicketDescription}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        This script is used to wrap the generic create-record command in ServiceNow.
        You can add fields that you want to create the record with as script arguments or in the
        code and work with the records easily.
      id: 4b0e11b0-60fd-4630-89f6-a3fecf503e57
      iscommand: false
      name: Open Snow ticket
      scriptName: ServiceNowCreateIncident
      type: regular
      version: -1
    taskid: 4b0e11b0-60fd-4630-89f6-a3fecf503e57
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -810,
          "y": 535
        }
      }
  "56":
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "54"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: ServiceNow v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 2394b4c9-48a8-4f34-8f74-16d6f6cae38b
      iscommand: false
      name: Is ServiceNow Available?
      scriptName: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 2394b4c9-48a8-4f34-8f74-16d6f6cae38b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -810,
          "y": 360
        }
      }
  "57":
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "70"
    note: false
    quietmode: 0
    results:
    - brandInstances
    scriptarguments:
      brandname:
        simple: jira-v2
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Returns 'yes' if integration brand is available. Otherwise returns
        'no'
      id: 7bae04fd-831d-43a4-85d2-490036807ee6
      iscommand: false
      name: Is Jira Available?
      scriptName: IsIntegrationAvailable
      type: condition
      version: -1
    taskid: 7bae04fd-831d-43a4-85d2-490036807ee6
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -390,
          "y": 360
        }
      }
  "60":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: inputs.DupAlertIDsToBeClosed
          operator: isNotEmpty
          right:
            value: {}
      - - ignorecase: true
          left:
            iscontext: true
            value:
              simple: inputs.CloseDuplicate
          operator: containsString
          right:
            value:
              simple: close
      label: "yes"
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "2"
      "yes":
      - "1"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 40a6d11a-2d7f-4ffd-8123-bae28f947cb3
      iscommand: false
      name: Additional Duplicate IDs were provided?
      type: condition
      version: -1
    taskid: 40a6d11a-2d7f-4ffd-8123-bae28f947cb3
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 1290
        }
      }
  "62":
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      comment:
        simple: Emergency containment
      file_hash:
        complex:
          accessor: SHA1
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Malicious
              operator: isNotEmpty
          root: File
      machine_id:
        simple: ${Endpoint.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Stop the execution of a file on a machine and delete it.
      id: 88697d44-7416-454d-8181-641a84f7fee8
      iscommand: true
      name: Quarantine this file on an affected machine
      script: '|||microsoft-atp-stop-and-quarantine-file'
      type: regular
      version: -1
    taskid: 88697d44-7416-454d-8181-641a84f7fee8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2570,
          "y": 720
        }
      }
  "63":
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      file_hash:
        complex:
          accessor: SHA1
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Malicious
              operator: isNotEmpty
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Get a collection of machines related to a given file SHA1 hash.
      id: 26d215ab-59d6-4bf3-810a-7d8a7963811a
      iscommand: true
      name: Get a list of devices associated with the malicious/suspicious SHA1 hashes
      script: '|||microsoft-atp-get-file-related-machines'
      type: regular
      version: -1
    taskid: 26d215ab-59d6-4bf3-810a-7d8a7963811a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -2570,
          "y": 575
        }
      }
  "64":
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3f271aea-d790-4519-82bd-38e0985b3683
      iscommand: false
      name: Done with isolating the infected device
      type: title
      version: -1
    taskid: 3f271aea-d790-4519-82bd-38e0985b3683
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2570,
          "y": 890
        }
      }
  "66":
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1bf90a27-a90f-4bcf-8596-8e2a417e2250
      iscommand: false
      name: Remove File
      type: title
      version: -1
    taskid: 1bf90a27-a90f-4bcf-8596-8e2a417e2250
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 110
        }
      }
  "68":
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      action:
        simple: Allowed
      indicator_description:
        simple: 'Added by Cortex XSOAR - Incident #${incident.id}'
      indicator_title:
        simple: 'Added by Cortex XSOAR - Incident #${incident.id} '
      indicator_type:
        simple: FileSha256
      indicator_value:
        simple: ${Indicators to block.Answers.0}
      severity:
        simple: Informational
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a new indicator.
      id: 6a1c3010-89a0-4eb2-824f-5f8943a71ee3
      iscommand: true
      name: Create IOC on Microsoft Defender For Endpoint
      script: '|||microsoft-atp-sc-indicator-create'
      type: regular
      version: -1
    taskid: 6a1c3010-89a0-4eb2-824f-5f8943a71ee3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1520,
          "y": 720
        }
      }
  "70":
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "25"
    note: false
    quietmode: 0
    scriptarguments:
      issueTypeName:
        simple: ${inputs.Comment}
      projectKey:
        simple: ${inputs.JiraProjectKey}
      summary:
        simple: ${inputs.TicketDescription}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Creates a new issue in Jira.
      id: 49a837f2-67f6-4dcb-8c1b-8d0b2dcc2cd3
      iscommand: true
      name: Open Jira Issue
      script: '|||jira-create-issue'
      type: regular
      version: -1
    taskid: 49a837f2-67f6-4dcb-8c1b-8d0b2dcc2cd3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -390,
          "y": 535
        }
      }
  "71":
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: Mark SHA1 to be deleted
        options: []
        optionsarg:
        - simple: ${incident.filesha1}
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: multiSelect
      sender: ""
      title: Confirm which SHA1 should be deleted
      totalanswers: 0
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "73"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1e99965c-d50b-4249-8a71-b36cd6e5e268
      iscommand: false
      name: Confirm which SHA1 should be deleted
      type: collection
      version: -1
    taskid: 1e99965c-d50b-4249-8a71-b36cd6e5e268
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": -2620,
          "y": 220
        }
      }
  "72":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Indicators to block.Answers.0
          operator: isNotEmpty
      label: "yes"
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "30"
      "yes":
      - "49"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7288a679-50af-440d-8f02-b7601d5bde7f
      iscommand: false
      name: Was there any hash selected?
      type: condition
      version: -1
    taskid: 7288a679-50af-440d-8f02-b7601d5bde7f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1740,
          "y": 370
        }
      }
  "73":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Confirm which SHA1 should be deleted.Answers
          operator: isNotEmpty
      label: "yes"
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "64"
      "yes":
      - "63"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 38b79c16-d53e-49b4-816c-e5065d25ec7d
      iscommand: false
      name: Was there any hash selected?
      type: condition
      version: -1
    taskid: 38b79c16-d53e-49b4-816c-e5065d25ec7d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -2780,
          "y": 400
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2190,
        "width": 2770,
        "x": -2780,
        "y": -170
      }
    }
  }
