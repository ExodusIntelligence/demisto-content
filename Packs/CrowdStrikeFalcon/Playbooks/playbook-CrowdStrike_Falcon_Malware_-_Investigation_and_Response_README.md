The playbook covers a detailed flow of handling a CrowdStrike Falcon malware investigation.
Included steps are:
Extracting and displaying MITRE data from the EDR and sandboxes
Deduplication similar incidents
Searching for the hashes in the alert in the sandboxes to provide their relevant information and in case the hashes are not found, retrieving them from the endpoint and detonating in the sandbox.
Verifying the actions taken by the EDR
Analyzing the command line
Search for the relevant hashes in additional hosts in the organization
Retrieve data about the host such as process list and network connections
Perform containment and mitigation actions as part of handling false/true positives 
Setting the relevant layouts and more

## Dependencies
This playbook uses the following sub-playbooks, integrations, and scripts.

### Sub-playbooks
* Crowdstrike Falcon - False Positive Incident Handling
* Retrieve Endpoint Forensics Data
* Dedup - Generic v4
* Search For Hash In Sandbox - Generic
* Detonate and Analyze File - Generic
* CrowdStrike Falcon Malware - Verify Containment Actions
* EMitre Attack - Extract Technique Information From ID
* CrowdStrike Falcon - Retrieve File
* CrowdStrike Falcon Malware - Incident Enrichment
* Command-Line Analysis
* CrowdStrike Falcon - Search Endpoints By Hash
* Crowdstrike Falcon - True Positive Incident Handling

### Integrations
This playbook does not use any integrations.

### Scripts
* InvestigationSummaryParse
* InvestigationDetailedSummaryParse
* SetAndHandleEmpty

### Commands
* closeInvestigation
* setIncident

## Playbook Inputs
---

| **Name** | **Description** | **Default Value** | **Required** |
| --- | --- | --- | --- |
| RetrieveFile | Indicates if file retrieval from the endpoint is allowed. <br/>True/False | true | Optional |
| DetonateFile | Indicates if file detonation is allowed on the sandbox.<br/>True/False | true | Optional |
| EnableDeduplication | Indicates if the deduplication playbook will be used.<br/>True/False | false | Optional |
| EnableClosureSteps | Indicates if use of closure steps is allow or incident will close automatically.<br/>True/False | true | Optional |
| TicketingSystemToUse | The name of the ticketing system to use, for example Jira or ServiceNow |  | Optional |
| BlockIOCTagName | The tag to assign for indicators to block. |  | Optional |
| AutoIsolation | Indicates if host isolation is allowed.<br/>True/False<br/> | false | Optional |
| AllowIOCTagName | The name of the tag to apply for allowed indicators. |  | Optional |
| TicketProjectName | For ticketing systems such as Jira a project name is required. |  | Optional |
| AutoUnisolation | Indicates if automatic un-isolation is allowed<br/>True/False | false | Optional |
| DidAlertOriginateFromSIEM | In case the alert originated from SIEM no need to run the Incident enrichment flow. | false | Optional |
| DedupHandleSimilar | This input defines how to handle Similar incidents. <br/>You may choose between: "Link", "Close", "Link and Close".<br/>Note: that closing incidents will require you to define "CloseSimilar" input as well.<br/>Also, note that the closer will apply on at least one of the options \(indicators or fields\) which will match the "closer percentage" criteria.<br/>Default: Link  | Link | Optional |
| DedupLimit | The maximum number of incidents to query and set to context data.<br/>Default is: 200 | 200 | Optional |
| DedupCloseSimilar | Define if you would like to close incidents by a similarity percentage. The percentage will be the bottom border for closing inc.<br/>This option will close also exact matches as well \( if there are\).<br/>Value should be between 0 to 1 \[0=low similarity , 1=identical\] |  | Optional |
| ApplyOCGlobally | Indicates if to apply the IOC is globally<br/>If specified False provide an input for the HostGroupName input with the group name.<br/>True/False | true | Optional |
| HostGroupName | The name of the list group to apply in case ApplyOCGlobally isn't set as True. |  | Optional |
| DedupSimilarTextField | A comma-separated list of incident text fields to take into account when computing similarity. For example commandline, URL | agnetsid,users,agentsid,CMDline,Hostnames,filenames,filepaths | Optional |
| DedupMinimunIncidentSimilarity | Retain incidents with a similarity score that's higher than the MinimunIncidentSimilarity.<br/>Default: 0.2<br/>Value should be between 0 to 1 \[0=low similarity, 1=identical\] | 0.2 | Optional |

## Playbook Outputs
---

| **Path** | **Description** | **Type** |
| --- | --- | --- |
| CrowdStrike | All the CrowdStrike data | unknown |
| Endpoint | All the endpoint data | string |

## Playbook Image
---
![CrowdStrike Falcon Malware - Investigation and Response](../doc_files/CrowdStrike_Falcon_Malware_-_Investigation_and_Response.png)